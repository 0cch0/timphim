---
const {title, list} = Astro.props
const movieList = list.filter(x => x.media_type == 'movie').slice(0, 8)
const tvList = list.filter(x => x.media_type == 'tv').slice(0, 8)

function getYear(media) {
	const date = media.release_date || media.first_air_date
	return date.slice(0, 4)
}
---

<b>{title}</b>
<hr class="hr-dot">

{movieList.length > 0 && (
	<div class="media-type">
		<b>Phim lẻ</b>
		<hr class="hr-line">
		<div class="list">
		{movieList.map(item => (
			<a href="#" class="item">
				<img src={`https://image.tmdb.org/t/p/w300${item.poster_path}`} draggable="false" />
				<div class="year">{getYear(item)}</div>
				<div class="title">{item.title}</div>
			</a>
		))}
		</div>
	</div>
)}

{tvList.length > 0 && (
	<div class="media-type">
		<b>Phim bộ</b>
		<hr class="hr-line">
		<div class="list">
		{tvList.map(item => (
			<a href="#" class="item">
				<img src={`https://image.tmdb.org/t/p/w300${item.poster_path}`} draggable="false" />
				<div class="year">{getYear(item)}</div>
				<div class="title">{item.name}</div>
			</a>
		))}
		</div>
	</div>
)}

<style>
	.hr-dot {
		overflow: visible;
    	height: 1.1rem;
    	margin: .8rem 0;
		border: none;
		background: radial-gradient(gray .5px, transparent 1px) 0 0/3px 3px, transparent;
	}
	.media-type {
		margin: 1.2rem 0;
	}
	.list {
		display: grid;
		grid-template-columns: repeat(4, minmax(0, 1fr));
		gap: 1rem;
	}
	.item {
		position: relative;
		border: 1px solid gray;
		box-shadow: 2px 2px silver;
		padding: .5rem;
		outline: none;
		&:hover, &:focus {
			background: steelblue;
			.title {
				white-space: wrap;
			}
		}
		&:active {
			transform: translate(1px, 1px);
			box-shadow: 1px 1px silver;
		}
		img {
			display: block;
			width: 100%;
			height: 100%;
		}
		.year {
			position: absolute;
			top: .5rem;
			left: .5rem;
			padding: .125rem .5rem;
			background: rgba(0, 0, 0, .5);
			color: white;
			font-size: 1.2rem;
		}
		.title {
			position: absolute;
			left: .5rem;
			right: .5rem;
			bottom: .5rem;
			padding: .25rem .5rem;
			background: rgba(0, 0, 0, .5);
			color: white;
			overflow: hidden;
			white-space: nowrap;
			text-overflow: ellipsis;
		}
	}
</style>
